<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GBK">
<title>E:\Dropbox\acm2013\m模板\计算几何\判断点是否在多边形内new.cpp.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="cpp">
<meta name="settings" content="use_css,number_lines">
<style type="text/css">
<!--
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.lnr { color: #804040; }
.Comment { color: #0000ff; }
.Constant { color: #ff00ff; }
.Statement { color: #804040; font-weight: bold; }
.Type { color: #2e8b57; font-weight: bold; }
-->
</style>
</head>
<body>
<pre>
<span class="lnr"> 1 </span><span class="Type">bool</span> onSegment(<span class="Type">const</span> point &amp;p, <span class="Type">const</span> point &amp;s, <span class="Type">const</span> point &amp;e) {
<span class="lnr"> 2 </span>    <span class="Statement">if</span> (p == s || p == e) <span class="Statement">return</span> <span class="Constant">true</span>;
<span class="lnr"> 3 </span>    <span class="Statement">if</span> (sgn((p - s) * (e - s)) == <span class="Constant">0</span> &amp;&amp; sgn((s - p) ^ (e - p)) &lt;= <span class="Constant">0</span>)
<span class="lnr"> 4 </span>        <span class="Statement">return</span> <span class="Constant">true</span>;
<span class="lnr"> 5 </span>    <span class="Statement">return</span> <span class="Constant">false</span>;
<span class="lnr"> 6 </span>}
<span class="lnr"> 7 </span><span class="Type">int</span> get_position(<span class="Type">const</span> point &amp;p, point *pol, <span class="Type">int</span> n) {
<span class="lnr"> 8 </span>    <span class="Type">int</span> wn = <span class="Constant">0</span>;
<span class="lnr"> 9 </span>    <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; n; i++) {
<span class="lnr">10 </span>        <span class="Statement">if</span> (onSegment(p, pol[i], pol[(i + <span class="Constant">1</span>) % n])) <span class="Statement">return</span> <span class="Constant">0</span>; <span class="Comment">//on the segment</span>
<span class="lnr">11 </span>        <span class="Type">int</span> k = sgn((pol[(i + <span class="Constant">1</span>) % n] - pol[i]) * (p - pol[i]));
<span class="lnr">12 </span>        <span class="Type">int</span> d1 = sgn(pol[i].y - p.y);
<span class="lnr">13 </span>        <span class="Type">int</span> d2 = sgn(pol[(i + <span class="Constant">1</span>) % n].y - p.y);
<span class="lnr">14 </span>        <span class="Statement">if</span> (k &gt; <span class="Constant">0</span> &amp;&amp; d1 &lt;= <span class="Constant">0</span> &amp;&amp; d2 &gt; <span class="Constant">0</span>) wn++;
<span class="lnr">15 </span>        <span class="Statement">if</span> (k &lt; <span class="Constant">0</span> &amp;&amp; d2 &lt;= <span class="Constant">0</span> &amp;&amp; d1 &gt; <span class="Constant">0</span>) wn--;
<span class="lnr">16 </span>    }
<span class="lnr">17 </span>    <span class="Statement">if</span> (wn != <span class="Constant">0</span>) <span class="Statement">return</span> <span class="Constant">1</span>; <span class="Comment">//inner</span>
<span class="lnr">18 </span>    <span class="Statement">else</span> <span class="Statement">return</span> -<span class="Constant">1</span>; <span class="Comment">//outter</span>
<span class="lnr">19 </span>}
</pre>
</body>
</html>
